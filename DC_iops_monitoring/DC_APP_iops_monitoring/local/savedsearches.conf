[dc_lookup_splunk_server]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 * * * *
description = Creates lookup for local splunk server name
dispatch.earliest_time = -15m
dispatch.latest_time = now
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = DC_splunk_quick_health
request.ui_dispatch_view = search
search = index=_internal splunk_server=local earliest=-5m@m latest=now    \
| table splunk_server | head 1\
| outputlookup create_empty=false createinapp=true override_if_empty=false my_splunk_server.csv

[iops_cpu_critical_monitor_linux]
action.email = 1
action.email.show_password = 1
action.email.to = demo@demo.com
action.email.useNSSubject = 1
alert.expires = 15m
alert.suppress = 1
alert.suppress.period = 15m
alert.track = 0
counttype = number of events
cron_schedule = */5 * * * *
description = Monitors CPU - checks every 15 mins, if over 90%, an event will be generated
dispatch.earliest_time = -15m
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = DC_APP_iops_monitoring
request.ui_dispatch_view = search
search = | mstats avg(_value) prestats=true WHERE metric_name="cpu.system" AND index="linux_metric" AND host="*"  span=15m\
| timechart avg(_value) AS Avg span=15m\
| eval threshold = round(Avg,0) \
| where threshold > 2\
| eval threshold = threshold."%" \
| eval alert_name = "CPU Critical Linux" \
| eval severity= "Critical" \
| eval message = "Average CPU value has been high for 15 minutes or more." \
| collect index=iops_alerts \
| fields - _span*

[iops_free_memory_critical_monitor_linux]
action.email = 1
action.email.show_password = 1
action.email.to = demo@demo.com
action.email.useNSSubject = 1
alert.expires = 1m
alert.suppress = 0
alert.track = 0
counttype = number of events
cron_schedule = */5 * * * *
description = Monitors free - available memory - if less than 2% free an event will be generated
dispatch.earliest_time = -15m
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = DC_APP_iops_monitoring
request.ui_dispatch_view = search
search = | mstats avg(_value) prestats=true WHERE metric_name="memory.free" AND index="linux_metric" AND host="*" span=10m\
| timechart avg(_value) AS Avg_mem span=10m\
| eval threshold = round(Avg_mem,0) \
| where threshold < 90\
| eval threshold = threshold."%" \
| eval alert_name = "Memory Critical Linux" \
| eval severity = "Critical" \
| eval message = "Free memory is low on this server and has been for over 10 minutes or more." \
| collect index=iops_alerts\
| fields - _span*

[iops_disk_free_critical_monitor_linux]
action.email = 1
action.email.show_password = 1
action.email.to = demo@demo.com
action.email.useNSSubject = 1
alert.expires = 5m
alert.suppress = 0
alert.track = 0
counttype = number of events
cron_schedule = */5 * * * *
description = Monitors Free Disk Space, if less than 5%, an event is logged
dispatch.earliest_time = -60m@m
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = DC_APP_iops_monitoring
request.ui_dispatch_view = search
search = | mstats avg(_value) prestats=true WHERE metric_name="df.free" AND index="linux_metric" AND host="*" span=15m\
| timechart avg(_value) AS Avg_disk span=15m\
| eval threshold = round(Avg_disk,0) \
| where threshold < 90\
| eval threshold = threshold."%" \
| eval alert_name = "Disk Critical Linux" \
| eval severity = "Critical" \
| eval message = "Disk free space is low on this server." \
| collect index=iops_alerts\
| fields - _span*

[iops_page_usage_critical_monitor_linux]
action.email = 1
action.email.show_password = 1
action.email.to = demo@demo.com
action.email.useNSSubject = 1
alert.expires = 5m
alert.suppress = 0
alert.track = 0
counttype = number of events
cron_schedule = */5 * * * *
description = Monitors swap file usage
dispatch.earliest_time = -60m@m
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = DC_APP_iops_monitoring
request.ui_dispatch_view = search
search = | mstats avg(_value) prestats=true WHERE metric_name="swap.used" AND index="linux_metric" AND host="*" span=15m\
| timechart avg(_value) AS Avg_page span=15m\
| eval threshold = round(Avg_page,0) \
| where threshold > 2\
| eval threshold = threshold."%" \
| eval alert_name = "Page Usage Critical Linux" \
| eval severity = "Critical" \
| eval message = "Paging is high on this server, memory could be low."\
| collect index=iops_alerts\
| fields - _span*
